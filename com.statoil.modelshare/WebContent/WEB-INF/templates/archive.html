<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="../fragments/header :: header"></head>
<body>

	<!-- shows a node with children -->
	<div th:fragment="modelList(modelNode)" th:remove="tag">
		<div th:if="${modelNode}" th:remove="tag">
			<!-- folder -->
			<div th:if="${modelNode.leaf == false}">
				<b><a th:href="@{/archive(item=${modelNode.relativePath},leaf=false)}" th:text="${modelNode.name}"></a></b>
			</div>
			<!-- model -->
			<div th:if="${modelNode.leaf == true}">
				<a th:href="@{/showModel(item=${modelNode.relativePath},leaf=true)}" th:text="${modelNode.name}"></a>
			</div>			
			<div th:each="child: ${modelNode.children}">
				<!-- folder -->
				<div th:if="${child.leaf == false}">
					<b><a th:href="@{/archive(item=${child.relativePath},leaf=false)}" th:text="${child.name}"></a></b>
				</div>
				<!-- model -->
				<div th:if="${child.leaf == true}">
					<a th:href="@{/showModel(item=${child.relativePath},leaf=true)}" th:text="${child.name}"></a>
				</div>
			</div>
		</div>
	</div>

	<!-- Flat view of folders -->
	<div class="container" role="main">
	
		<div th:replace="../fragments/navbar :: navbar(archive, ${topLevel})"></div>

		<div th:replace="../fragments/breadcrumb :: breadcrumb(${crumbs},${currentFolder})">BreadCrumb</div>

		<div th:replace="../fragments/alert :: alert(${error},${info})"></div>
		
		<div class="panel panel-primary">
			<div class="panel-body" th:if="${not #lists.isEmpty(node.children)}"
				th:with="maxIndex=${#lists.size(node.children)-1}">
				<div th:each="index: ${#numbers.sequence(0, maxIndex, 3)}">
					<div class="row">
						<div class="col-md-4">
							<div th:replace=":: modelList(${node.children.get(index)})">...</div>
						</div>
						<div class="col-md-4" th:if="${index+1 le maxIndex}">
							<div th:replace=":: modelList(${node.children.get(index + 1)})">...</div>
						</div>
						<div class="col-md-4" th:if="${index+2 le maxIndex}">
							<div th:replace=":: modelList(${node.children.get(index + 2)})">...</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div th:replace="../fragments/footer :: footer">...</div>

</body>
</html>
